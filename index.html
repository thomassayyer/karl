<!DOCTYPE html>
<html>
<head>
    <title>Karl</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/app.css">
</head>
<body>

    <section id="main_section" class="container-fluid bg-primary">

        <h1 id="app_title" class="text-center">Karl</h1>
        <hr class="separator">

        <div class="row">
            <div class="col-md-6">
                <div class="col-md-12">
                    <h2 class="h3 text-center">Générer un nombre aléatoire</h2>
                </div>
                <div class="col-md-12">
                    <div id="random_number" class="text-center">
                        0
                    </div>
                </div>
                <div class="col-md-12">
                    <button id="generate_button" class="btn-rounded">
                        Générer un nombre aléatoire
                    </button>
                </div>
                <div class="col-md-12">
                    <select id="law_select" class="form-control">
                        <option selected disabled>- Loi associée -</option>
                        <option value="0">Loi uniforme</option>
                        <option value="1">Loi normale</option>
                        <option value="2">Loi de Poisson</option>
                        <option value="3">Loi exponentielle</option>
                    </select>
                </div>
                <div class="col-md-12">
                    <div id="lambda_form" class="hidden">
                        <input type="number" id="lambda_input" class="form-control" placeholder="λ">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="col-md-12">
                    <h2 class="h3 text-center">Simuler un processus de Poisson</h2>
                </div>
                <div class="col-md-12">
                    <div id="poisson_process_container"></div>
                </div>
                <div class="col-md-12">
                    <button id="poisson_process_simulation_button" class="btn-rounded">
                        Simuler le processus
                    </button>
                </div>
                <div class="col-md-12">
                    <input type="number" id="n_poisson_process_input" class="form-control" placeholder="n">
                    <input type="number" id="lambda_poisson_process_input" class="form-control" placeholder="λ" step="any">
                </div>
            </div>
        </div>

    </section>

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/highcharts.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript">
        
        $(function()
        {
            $('#poisson_process_container').highcharts({
                chart: {
                    type: 'scatter'
                },
                title: {
                    text: 'Processus simulé'
                },
                series: [{
                    data: [ ]
                }]
            });

            // Action lors du clic sur le bouton de génération d'un nombre
            // aléatoire.
            $('#generate_button').on('click', function()
            {
                let law  = parseInt($('#law_select').val(), 10);

                switch (law)
                {
                    case 0:
                        $('#random_number').text(
                            Math.random().toFixed(4)
                        );
                        break;
                    case 1:
                        $('#random_number').text(
                            Math.normalRandom().toFixed(4)
                        );
                        break;
                    case 2:
                        var lambda = parseFloat($('#lambda_input').val());
                        $('#random_number').text(
                            Math.poissonRandom(lambda)
                        );
                        break;
                    case 3:
                        var lambda = parseFloat($('#lambda_input').val());
                        $('#random_number').text(
                            Math.expRandom(lambda).toFixed(4)
                        );
                        break;
                }
            });

            // Action lors du changement de loi associée.
            $('#law_select').on('change', function()
            {
                $('#lambda_form').val('').addClass('hidden');

                switch (parseInt($(this).val(), 10))
                {
                    case 2:
                    case 3:
                        $('#lambda_form').removeClass('hidden');
                        break;
                }
            });

            // Action lors du clic sur le bouton de simulation d'un processus de
            // Poisson.
            $('#poisson_process_simulation_button').on('click', function()
            {
                let chart  = $('#poisson_process_container').highcharts();
                let lambda = parseFloat($('#lambda_poisson_process_input').val());
                let n      = parseInt($('#n_poisson_process_input').val(), 10);

                // On vide le graphique.
                chart.series[0].remove(true);
                chart.addSeries({
                    data: [ ]
                });

                for (let timer = 0; timer < n; timer += Math.expRandom(lambda))
                {
                    chart.series[0].addPoint(
                        [ timer, 1 ], true
                    );
                }
            });
        });

    </script>

</body>
</html>